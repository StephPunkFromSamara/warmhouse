# Project_template
Это шаблон для решения проектной работы. Структура этого файла повторяет структуру заданий. Заполняйте его по мере работы над решением.

# ✅ Задание 1. Анализ и планирование
Чтобы составить документ с описанием текущей архитектуры приложения, можно часть информации взять из описания компании и условия задания. Это нормально.

1. Описание функциональности монолитного приложения

**Управление отоплением:** 
- Пользователи могут управлять системой отопления дистанционно в своему доме. 
- Система поддерживает интеграцию по управлению отоплением по интернет-каналу.
- Система может получать нагревать помещение до определенной температуры по показаниям с датчика.

**Мониторинг температуры:**
- Пользователи могу наблюдать температуры помещения в веб-интерфейсе. 
- Система может отправлять данные о температуре и в последствии определять какой это датчик/время и локацию.

2. Анализ архитектуры монолитного приложения
**Общие характеристики:**
- Интеграция систем отопления и умного дома реализована синхронно.
- Отсуствует обратная совместимость между новыми версиями приложения, поскольку требуется постоянно новое обновление приложений.

**Технологический стек:**
- _Язык программирования_: **Go**
 - _База данных_: **PostgreSQL**
 - _Архитектура_: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения. 
 - _Взаимодействие_: Интеграция систем отопления и умного дома реализована синхронно. Взаимодействие между компонентами реализованно в рамках вызова функции. 
В текущем решении система Умный дома сама опрашивает датчики и получает информации с них.
 - _Масштабируемость_: Ограничена, так как монолит сложно масштабировать по частям.
 - _Развертывание_: Требует остановки всего приложения. При развертывании требуется дополнительная настройка от специалиста.

3. Определение доменов и границы контекстов
- Домен управление устройствами
  - поддомен управление устройствами
    - контекст: управление домашними устройствами
    - контекст: реестр устройств
    - контекст: настройка сценариев
  - поддомен мониторинг показателей
    - контекст: мониторинг технических показателей
    - контекст: трансляция 


4. Проблемы монолитного решения
- Определение параметров сущности **sensor** через другой метод, тесно связанная логика без хранения собственного атрибута в рамках объекта. Правильнее получать значение внутри датчика и потом распределять по температуре ли он.
- Если нужно масштабировать сервис по мониторингу температуры, что довольно частый кейс с увеличением количества домов, придется масштабировать и систему управления отоплением.


5. Визуализация контекста системы — диаграмма С4

[Диаграмма контекста](/schemas/diagramOfContext.puml)


# ✅ Задание 2. Проектирование микросервисной архитектуры

В этом задании вам нужно предоставить только диаграммы в модели C4. Мы не просим вас отдельно описывать получившиеся микросервисы и то, как вы определили взаимодействия между компонентами To-Be системы. Если вы правильно подготовите диаграммы C4, они и так это покажут.

**Диаграмма контейнеров (Containers)**

[Диаграмма контейнеров](/schemas/diagramOfContainers.puml)

**Диаграмма компонентов (Components)**

Добавьте диаграмму для каждого из выделенных микросервисов.

[Обработка пользовательских сценариев/управление устройствами](/schemas/components/diagramOfScenario.puml)

[Учетные записи](/schemas/components/diagramOfRegistryOfUserAccount.puml)

[Мониторинг показателей](/schemas/components/diagramOfMonitoringService.puml)

[Реестр устройств](/schemas/components/diagramOfRegistryService.puml)

[Стримминг видео](/schemas/components/diagramOfVideoService.puml)

**Диаграмма кода (Code)**

[Диаграмма кода](/schemas/diagramCode.puml)

# ✅ Задание 3. Разработка ER-диаграммы

Добавьте сюда ER-диаграмму. Она должна отражать ключевые сущности системы, их атрибуты и тип связей между ними.

[ER-диаграмма](/schemas/diagramCode.puml)

# ✅ Задание 4. Создание и документирование API

### 1. Тип API
Для взаимодействия микросервисов используется `AsyncAPI` посредством брокера сообщений. Микросервисы подписаны на топики об обновлении и создании сущностей и получении данных с датчиков. 
Это позволяет не запрашивать данные каждый раз требуя синхронного ответа от сервисов, тем самым сервисы требуют меньше ресурсов и являются более производительными.
Без брокера сообщений получает данные только микросервис трансляции видео по `RTSP`.

Между клиентом (микрофронтендом) и микросервисами используется синхронный обмен данных  `REST API`, за исключением передачи видеопотока в клиентский интерфейс используется `WEBRTC`

### 2. Документация API

Здесь приложите ссылки на документацию API для микросервисов, которые вы спроектировали в первой части проектной работы. Для документирования используйте Swagger/OpenAPI или AsyncAPI.

#### Пользователи 
- [Rest](/apps/apps/smart_home/services/user-service/openapi/user-api.yaml)
- [Async](/apps/apps/smart_home/services/user-service/asyncapi/user-events.yaml)
---
#### Устройства 
- [Rest](/apps/apps/smart_home/services/device-service/openapi/device-api.yaml)
- [Async](/apps/apps/smart_home/services/device-service/asyncapi/device-events.yaml)
---
- #### Сценарии для устройств
- [Rest](/apps/apps/smart_home/services/scenario-service/openapi/scenario-api.yaml)
- [Async](/apps/apps/smart_home/services/scenario-service/asyncapi/scenario-events.yaml)
---
- #### Мониторинг показателей
- [Rest](/apps/apps/smart_home/services/monitoring-service/openapi/monitoring-api.yaml)
- [Async](/apps/apps/smart_home/services/monitoring-service/asyncapi/monitoring-events.yaml)

- #### Видео слежение 
- [Rest](/apps/apps/smart_home/services/video-service/openapi/video-api.yaml)
- [Async](/apps/apps/smart_home/services/video-service/asyncapi/video-events.yaml)

#   ❌ Задание 5. Работа с docker и docker-compose
